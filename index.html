<!DOCTYPE html>
<html lang="">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Wave Runner</title>

    <script src="../p5.min.js"></script>
    <script src="../addons/p5.dom.min.js"></script>
    <script src="../addons/p5.sound.min.js"></script>
    <script src="land.js"></script>
    <script src="hero.js"></script>
    <script src="platform.js"></script>
    <script src="create_platforms.js"></script>
    <script src="music_controls.js"></script>
    <script src="hero_controls.js"></script>
    <script src="Ring.js"></script>
    <script src="create_rings.js"></script>
    <script src="load_sprites.js"></script>
  </head>

  <body>
      
      <script>

        let song;
        let volumeArray = [];
        let waveYArray = [];
        let platforms = [];
        let rings = [];

        let wavesArray;
        let seekLinePos;
        let jumpLimit = 5; 
        let currentJump = 0;


        function preload() {
          loadSprites();
        }

        function setup() {
          // createCanvas(400, 500);
          createCanvas(1200, 700);
          song = loadSound('escape.mp3', loaded);
       

          amp = new p5.Amplitude();
          hero = new Hero();
          frameRate(30); 
          createPlatforms();
          createRings();
          // for (let i = 0; i < 350; i++) {
          //   volumeArray.push(0);
          // }

        }

        

        function loaded() {
          console.log('loaded');
          button = createButton('play');
          button.mousePressed(toggle);
          
        }


        function draw() {
          background(0);
          drawWaves();
          
          

          platforms.forEach(platform => platform.drawPlatform());
          platforms.forEach(platform => platform.movePlatform());
          platforms[0].displayPlatform('first');
          platforms.forEach(platform => platform.displayPlatform());
          if (platforms[0].x + 100 < 0 ) {
            platforms = rotatePlatforms(platforms);
          }
          
          
          rings.forEach(ring => ring.drawRing());
          rings.forEach(ring => ring.moveRing());
          if (rings[0].x + 30 < 0) {
            rings = rotateRings(rings);
          }
          darkSide();
          platforms[0].displayPlatform('first');

          hero.move();
          hero.display();
          heroControl();
        }


      </script>
    
  </body>
</html>
